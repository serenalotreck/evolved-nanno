# Variant calling pipeline
In this project, we used the [`nf-core/sarek`](https://nf-co.re/sarek/3.5.1/) pipeline with the [strelka](https://github.com/Illumina/strelka) variant caller. This directory contains the information needed to re-run our work.

We used the tumor/normal functionality of strelka to compare each treatment sample to the control. This accounts for any differences between the control samples and the reference genome, which would otherwise look important. Because we were using mixed populations of a haploid organism, and because we had multiple replicates of each treatment and control, our data doesn't fit squarely into the paradigm that strelka was designed for.

After testing several additional callers, some of which were designed explicitly for mixed haploid samples, we decided to use strelka. None of the other callers could recover the EMS transition bias of C->T transitions, and most had strange biases towards some other transition in all samples, including the control. We recognize that the assumption of a diploid could affect the alternate allele frequencies calculated from the strelka outputs; however, we did not trust the presence/absence of variants provided by other callers.

Another issue we encountered is that sarek only allows one normal (control) sample per "patient". That, combined with the fact that the treatment samples really contitute different "tumors", led us to use 4 separate spreadsheets, so that we could obtain a pairwise comparison of every treatment rep against every control rep. In the final implementation, we used a slurm array job to submit all 4 samplesheets at the same time; because we used a shared work & output directory, we couldn't use the `-resume` function; however, the pipeline is rather quick even run start to finish.